var n=Object.defineProperty,e=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,a=(e,t,s)=>t in e?n(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,i=(n,i)=>{for(var o in i||(i={}))t.call(i,o)&&a(n,o,i[o]);if(e)for(var o of e(i))s.call(i,o)&&a(n,o,i[o]);return n};import{r as o,o as r,c,a as l,w as u,T as A,b as d,d as V,e as g,f as h,u as m,g as p,F as v,h as S,n as T,i as y,t as f,j as $,k as C,l as E,m as k,p as I,q as x,s as w,v as Q,x as B,y as O,z as b,A as F}from"./vendor.6c614042.js";!function(){const n=document.createElement("link").relList;if(!(n&&n.supports&&n.supports("modulepreload"))){for(const n of document.querySelectorAll('link[rel="modulepreload"]'))e(n);new MutationObserver((n=>{for(const t of n)if("childList"===t.type)for(const n of t.addedNodes)"LINK"===n.tagName&&"modulepreload"===n.rel&&e(n)})).observe(document,{childList:!0,subtree:!0})}function e(n){if(n.ep)return;n.ep=!0;const e=function(n){const e={};return n.integrity&&(e.integrity=n.integrity),n.referrerpolicy&&(e.referrerPolicy=n.referrerpolicy),"use-credentials"===n.crossorigin?e.credentials="include":"anonymous"===n.crossorigin?e.credentials="omit":e.credentials="same-origin",e}(n);fetch(n.href,e)}}();const D={id:"game-container"},H={__name:"App",setup:n=>(n,e)=>{const t=o("router-view");return r(),c("div",D,[l(t,null,{default:u((({Component:n})=>[l(A,{name:"fade",mode:"out-in"},{default:u((()=>[(r(),d(V(n)))])),_:2},1024)])),_:1})])}};const K=g("game",{state:()=>({currentTime:new Date("2026-02-18T23:30:00"),sanValue:100,connections:{girlfriend:80,stranger:50,haiming:50,mother:60},dialogueHistory:{},currentOptions:[],isWaitingForChoice:!1,currentCharacter:null,lastInteractions:{},screenShake:!1,visualDistortion:0,savedVisualDistortion:null,gameStarted:!1,gameEnded:!1,endingType:null,showEndingModal:!1,osText:{text:"",visible:!1,isEnding:!1,waitingForRestart:!1},unlockedEndings:JSON.parse(localStorage.getItem("unlockedEndings")||"[]"),onSanChange:null,onOsTextEnd:null}),actions:{resetGame(){this.currentTime=new Date("2026-02-18T23:30:00"),this.sanValue=100,this.connections={girlfriend:80,stranger:50,haiming:50,mother:60},this.dialogueHistory={},this.currentOptions=[],this.isWaitingForChoice=!1,this.currentCharacter=null,this.lastInteractions={},this.screenShake=!1,this.visualDistortion=0,this.gameStarted=!1,this.gameEnded=!1,this.endingType=null,this.osText={text:"",visible:!1}},startGame(){this.gameStarted=!0,this.updateAllLastInteractions()},endGame(n){this.gameEnded=!0,this.endingType=n,this.showEndingModal=!0,this.unlockEnding(n)},hideEndingModal(){this.showEndingModal=!1},advanceTime(n){this.currentTime=new Date(this.currentTime.getTime()+1e3*n),this.currentTime>=new Date("2026-02-19T00:30:00")&&this.endGame("time_up")},changeSan(n){this.sanValue,this.sanValue=Math.max(0,Math.min(100,this.sanValue+n)),this.updateVisualDistortion(),this.onSanChange&&this.onSanChange(this.sanValue)},changeConnection(n,e){void 0!==this.connections[n]&&(this.connections[n]=Math.max(0,Math.min(100,this.connections[n]+e)),this.connections[n]<20&&console.log(`${n} 关系破裂`))},addMessage(n,e,t,s="text"){this.dialogueHistory[n]||(this.dialogueHistory[n]=[]),this.dialogueHistory[n].push({id:Date.now()+Math.random(),speaker:e,content:t,type:s,timestamp:new Date(this.currentTime)})},showOptions(n,e){this.currentCharacter=n,this.currentOptions=e,this.isWaitingForChoice=!0},showOsText(n,e=!1){this.savedVisualDistortion=this.visualDistortion,this.visualDistortion=0,this.osText.text=n||"",this.osText.visible=!0,this.osText.isEnding=e,this.osText.waitingForRestart=!1},setWaitingForRestart(){this.osText.waitingForRestart=!0},hideOsText(){this.osText.visible=!1,this.osText.isEnding=!1,this.osText.waitingForRestart=!1,null!==this.savedVisualDistortion&&(this.visualDistortion=this.savedVisualDistortion,this.savedVisualDistortion=null),this.onOsTextEnd&&this.onOsTextEnd()},setOnOsTextEnd(n){this.onOsTextEnd=n},unlockEnding(n){this.unlockedEndings.includes(n)||(this.unlockedEndings.push(n),localStorage.setItem("unlockedEndings",JSON.stringify(this.unlockedEndings)))},isEndingUnlocked(n){return this.unlockedEndings.includes(n)},clearOptions(){this.currentOptions=[],this.isWaitingForChoice=!1},triggerScreenShake(){this.screenShake=!0,setTimeout((()=>{this.screenShake=!1}),500)},updateLastInteraction(n){this.lastInteractions[n]=new Date(this.currentTime)},updateAllLastInteractions(){Object.keys(this.connections).forEach((n=>{this.lastInteractions[n]=new Date(this.currentTime)}))},updateVisualDistortion(){this.sanValue>70?this.visualDistortion=0:this.sanValue>30?this.visualDistortion=1:(this.visualDistortion=2,this.sanValue<20&&(this.visualDistortion=3))},canEnterMyLine(){return this.sanValue<20},getConnectionStatus(n){const e=this.connections[n];return e>80?"high":e>20?"medium":"low"}},getters:{getHistory:n=>e=>n.dialogueHistory[e]||[],getSanLevel:n=>n.sanValue>70?"stable":n.sanValue>30?"unstable":n.sanValue>20?"critical":"broken",getGameTime:n=>`${n.currentTime.getHours().toString().padStart(2,"0")}:${n.currentTime.getMinutes().toString().padStart(2,"0")}:${n.currentTime.getSeconds().toString().padStart(2,"0")}`}});const M={class:"tab-bar"},G={__name:"TabBar",setup:n=>(n,e)=>{const t=o("router-link");return r(),c("div",M,[l(t,{to:"/",class:"tab-item","active-class":"active"},{default:u((()=>[...e[0]||(e[0]=[h("img",{src:"/assets/contacts.3e97bce4.png",alt:"聊天",class:"icon"},null,-1),h("span",{class:"label"},"微信",-1)])])),_:1}),l(t,{to:"/contacts",class:"tab-item","active-class":"active"},{default:u((()=>[...e[1]||(e[1]=[h("img",{src:"/assets/discover.463adfaa.png",alt:"发现",class:"icon"},null,-1),h("span",{class:"label"},"发现",-1)])])),_:1}),l(t,{to:"/endings",class:"tab-item","active-class":"active"},{default:u((()=>[...e[2]||(e[2]=[h("img",{src:"/assets/me.788f55b4.png",alt:"我",class:"icon"},null,-1),h("span",{class:"label"},"我",-1)])])),_:1})])},__scopeId:"data-v-36591aa4"};var R="/src/assets/characters/girlfriend/avatar.png";const U={class:"chat-list-container"},P={class:"chat-list"},J=["onClick"],q={class:"avatar"},_=["src","alt"],L={class:"chat-info"},j={class:"chat-header"},Y={class:"name"},W={class:"time"},N={class:"last-message"},X={class:"message"},Z={class:"notification-area"},z={__name:"ChatListView",setup(n){const e=m(),t=K(),s=p([{id:"girlfriend",name:"女友",avatar:R}]);function a(n){const e=t.getHistory(n);if(e.length>0){const n=e[e.length-1];return n.content.length>20?n.content.substring(0,20)+"...":n.content}return"暂无消息"}function i(n){const e=t.getHistory(n);if(e.length>0){const n=e[e.length-1].timestamp;return`${n.getHours().toString().padStart(2,"0")}:${n.getMinutes().toString().padStart(2,"0")}`}return""}function o(n){const e=t.connections[n];return e>80?"high":e>20?"medium":"low"}return(n,u)=>(r(),c("div",U,[u[0]||(u[0]=h("div",{class:"header"},[h("h1",null,"微信"),h("div",{class:"header-buttons"},[h("img",{src:"/assets/search.4b02e774.png",alt:"搜索"}),h("img",{src:"/assets/addNew.f680a20a.png",alt:"添加"})])],-1)),h("div",P,[(r(!0),c(v,null,S(s.value,(n=>(r(),c("div",{key:n.id,onClick:t=>{return s=n.id,void e.push(`/conversation/${s}`);var s},class:T(["chat-item",{"high-conn":y(t).connections[n.id]>80,"low-conn":y(t).connections[n.id]<20}])},[h("div",q,[h("img",{src:n.avatar,alt:n.name},null,8,_),h("div",{class:T(["conn-indicator",o(n.id)])},null,2)]),h("div",L,[h("div",j,[h("h3",Y,f(n.name),1),h("span",W,f(i(n.id)),1)]),h("div",N,[h("span",X,f(a(n.id)),1)])]),h("div",Z,[(n.id,$("",!0))])],10,J)))),128))]),l(G)]))},__scopeId:"data-v-8d372d4e"};var nn="data:image/png;base64,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";class en{constructor(){this.gameStore=K(),this.dialogueTrees={},this.characterStates={},this.messageHandlers={},this.missedCheckIntervals={}}async loadAndStart(n,e,t="23:30"){this.gameStore.dialogueHistory[n]&&this.gameStore.dialogueHistory[n].length>0?console.log(`GameEngine: ${n} 已有对话历史，跳过重新开始`):(this.dialogueTrees[n]=function(n){const e=n.split("\n").map((n=>n.trim())),t={};let s=null,a=[],o={},r={};const c=/^\$(.*?)\$/,l=/<(.*?)>/,u=/^(.*?): (.*)$/,A=/^(\d+)\. (.*)$/,d=/^\/\/ 选项(\d+) -> 跳转至 \$(.*?)\$$/,V=/^\/\/ 选项(\d+) 效果: (.*)$/,g=/^<OS_Text>\s*(.*?)\s*<\/OS_Text>$/;for(let h=0;h<e.length;h++){const n=e[h];if(!n||n.startsWith("// ---"))continue;const m=n.match(c);if(m){a.length>0&&s&&(t[s].push({type:"OPTIONS",choices:a.map((n=>i({text:n.text,target:o[n.index]},r[n.index])))}),a=[],o={},r={}),s=m[1],t[s]=[];continue}if(!s)continue;const p=n.match(g);if(p){t[s].push({type:"COMMAND",command:"OS_Text",args:[p[1]]});continue}const v=n.match(l);if(v){const[n,...e]=v[1].split(":").map((n=>n.trim()));t[s].push({type:"COMMAND",command:n,args:e});continue}if("[options]:"===n){a=[],o={},r={};continue}const S=n.match(A);if(S){a.push({index:S[1],text:S[2]});continue}const T=n.match(d);if(T){const[,n,e]=T;o[n]=e;continue}const y=n.match(V);if(y){const[,n,e]=y,t={};e.split(",").map((n=>n.trim())).forEach((n=>{const[e,s]=n.split(":").map((n=>n.trim()));"SanEffect"===e?t.sanEffect=parseInt(s):"ConnEffect"===e&&(t.connEffect=parseInt(s))})),r[n]=t;continue}if(n.includes("<SanCheck>")||n.includes("</SanCheck>")||n.includes("<条件检测>")||n.includes("</条件检测>")||n.includes("<条件1:")||n.includes("<条件2:")||n.includes("条件1:")||n.includes("条件2:"))continue;const f=n.match(u);if(f){const[,n,e]=f;t[s].push({type:"DIALOGUE",speaker:n,content:e})}else if(n.startsWith("// -> 跳转至")){const e=n.match(/\$(.*?)\$/);if(e){const n=e[1];t[s].push({type:"JUMP",target:n})}}}return a.length>0&&s&&t[s].push({type:"OPTIONS",choices:a.map((n=>i({text:n.text,target:o[n.index]},r[n.index])))}),t}(e),this.characterStates[n]={currentBlock:null,instructionPointer:0},await this.jumpToBlock(n,t),await this.processQueue(n),this.startMissedCheck(n))}jumpToBlock(n,e){this.dialogueTrees[n]&&this.dialogueTrees[n][e]?(this.characterStates[n]||(this.characterStates[n]={currentBlock:null,instructionPointer:0}),this.characterStates[n].currentBlock=this.dialogueTrees[n][e],this.characterStates[n].instructionPointer=0):console.error(`错误：找不到对话块 [${e}] 或角色 [${n}]`)}async processQueue(n){if(this.gameStore.isWaitingForChoice)return;const e=this.dialogueTrees[n],t=this.characterStates[n];if(e&&t&&t.currentBlock)for(;t.instructionPointer<t.currentBlock.length;){const e=t.instructionPointer,s=t.currentBlock[e];if("COMMAND"===s.type&&"OS_Text"===s.command)return void this.executeCommand(n,s.command,s.args);if("COMMAND"===s.type&&"Ending"===s.command)return void this.executeCommand(n,s.command,s.args);t.instructionPointer++;if(!(await this.executeInstruction(n,s)))break}}async executeInstruction(n,e){switch(e.type){case"DIALOGUE":return this.gameStore.addMessage(n,e.speaker,e.content),this.gameStore.advanceTime(10),await this.delay(1e3),!0;case"COMMAND":return this.executeCommand(n,e.command,e.args),!0;case"OPTIONS":return this.gameStore.showOptions(n,e.choices),!1;case"JUMP":return await this.jumpToBlock(n,e.target),await this.processQueue(n),!1}return!0}executeCommand(n,e,t){switch(e){case"TimeFlow":this.gameStore.advanceTime(parseInt(t[0].replace("s","")));break;case"SanEffect":this.gameStore.changeSan(parseInt(t[0]));break;case"ConnEffect":this.gameStore.changeConnection(n,parseInt(t[0]));break;case"ScreenShake":this.gameStore.triggerScreenShake();break;case"SetCharacter":this.currentCharacter=t[0];break;case"OS_Text":console.log("OS_Text被调用，内容:",t[0]),this.gameStore.showOsText(t[0]);break;case"Ending":console.log("Ending被调用，类型:",t[0]),this.gameStore.endGame(t[0])}}async selectOption(n,e){this.gameStore.isWaitingForChoice&&(this.gameStore.clearOptions(),this.gameStore.updateLastInteraction(n),e.sanEffect&&this.gameStore.changeSan(e.sanEffect),e.connEffect&&this.gameStore.changeConnection(n,e.connEffect),setTimeout((()=>{e.target&&this.jumpToBlock(n,e.target),this.processQueue(n)}),500))}startMissedCheck(n){this.missedCheckIntervals[n]=setInterval((()=>{const e=this.gameStore.lastInteractions[n];if(!e)return;(this.gameStore.currentTime-e)/1e3/60>=5&&(this.gameStore.changeConnection(n,-8),this.gameStore.changeSan(-3),this.gameStore.updateLastInteraction(n))}),1e4)}stopMissedCheck(n){this.missedCheckIntervals[n]&&(clearInterval(this.missedCheckIntervals[n]),delete this.missedCheckIntervals[n])}delay(n){return new Promise((e=>setTimeout(e,n)))}}const tn=p(null),sn=p(null),an=p(null),on=p(!1);let rn=null,cn=null,ln=null,un=null,An=null,dn=!1;const Vn=()=>{tn.value=new Audio("/assets/bgm.762d458a.mp3"),tn.value.loop=!0,tn.value.volume=.5,tn.value.crossOrigin="anonymous",sn.value=new Audio("/assets/messageSend.28be86ba.mp3"),sn.value.volume=.5,an.value=new Audio("data:audio/mpeg;base64,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//lEYlkv1hG43P3q9uHKRQAMAIAIAADJD3O6YNwZR/nTJSYRCUflP+Y4WJwSh1K/+Bm6AHZjeB68QFTwHT4KSXwOPUAwh8DNBxbFK/AwCcDcPQOBLAJEBgtda/wMEPAJJAZ00BmTQ6ABRHUr+BkzgCBIGKBg2DQ4kDCDQP/7kmQ2AAZKaEhGcoAAAAANIMAAAAAAAaQcAAAgAAA0g4AABMkbV9f8LEgwUJtAiCAxYoDGkhWokQAIT//8CAEDCAwMADJUG3QMMNBvMDc4WUHtAAgv///Aw4wP1G8HpBgUDAAQMEFJ4TaAQBDAwNsgsiGeBuV////+BgQwciHKlpVMQU1FMy4xMDBVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVU="),an.value.volume=.3,tn.value.addEventListener("ended",(()=>{on.value&&tn.value.play().catch((()=>{}))}))},gn=()=>{sn.value&&(sn.value.currentTime=0,sn.value.play().catch((()=>{})))},hn=()=>{an.value&&(an.value.currentTime=0,an.value.play().catch((()=>{})))},mn=()=>{tn.value&&!on.value&&(dn||(rn=new(window.AudioContext||window.webkitAudioContext),cn=rn.createMediaElementSource(tn.value),ln=rn.createBiquadFilter(),un=rn.createStereoPanner(),An=rn.createGain(),cn.connect(ln),ln.connect(un),un.connect(An),An.connect(rn.destination),dn=!0),rn&&"suspended"===rn.state&&rn.resume(),on.value=!0,tn.value.play().catch((()=>{})),requestAnimationFrame(Tn))},pn=()=>{tn.value&&on.value&&(on.value=!1,tn.value.pause())};let vn=100;const Sn=n=>{vn=n},Tn=()=>{if(!on.value||!dn)return;const n=1-vn/100,e=rn.currentTime,t=1-.7*Math.pow(n,1.5),s=n>.3?.08*Math.sin(Date.now()/200)*n:0;tn.value.playbackRate=Math.max(.1,t+s);const a=2e4*Math.pow(1-n,2)+100;if(ln.frequency.setTargetAtTime(a,e,.1),n>.5){const t=Math.sin(Date.now()/800)*n;un.pan.setTargetAtTime(t,e,.1)}else un.pan.setTargetAtTime(0,e,.1);let i=.6;if(n>.7){i=(.5+.2*Math.sin(Date.now()/150)*n)*(Math.random()>.98?.1:1)}An.gain.setTargetAtTime(i,e,.1),requestAnimationFrame(Tn)};function yn(){return{initAudio:Vn,playMessageSendSound:gn,playKeyboardSound:hn,startBgm:mn,stopBgm:pn,updateBgmBasedOnSan:Sn,isBgmPlaying:on}}const fn={class:"os-text-content"},$n={key:0,class:"cursor"},Cn={key:1,class:"continue-hint"},En={__name:"OsTextView",props:{text:{type:String,required:!0},visible:{type:Boolean,default:!1},isEnding:{type:Boolean,default:!1},waitingForRestart:{type:Boolean,default:!1}},setup(n){const{playKeyboardSound:e}=yn(),t=m(),s=K(),a=n,i=p(""),o=p(!1);let l=null,u=0;const A=()=>{u++;const n=u;if(console.log("OsTextView: startTyping()被调用, text:",a.text,"version:",n),l&&(clearInterval(l),l=null),i.value="",o.value=!0,!a.text||""===a.text.trim())return console.log("OsTextView: text为空或undefined"),o.value=!1,void(a.isEnding&&s.setWaitingForRestart());let t=0;l=setInterval((()=>{if(n!==u)return clearInterval(l),void(l=null);t<a.text.length?(i.value+=a.text[t],e(),t++):(l&&n===u&&(clearInterval(l),l=null),o.value=!1,console.log("OsTextView: 打字完成"),a.isEnding&&s.setWaitingForRestart())}),50)},d=()=>{s.hideOsText(),s.resetGame(),t.push("/")},V=()=>{o.value||a.waitingForRestart||a.isEnding||s.hideOsText()};return C((()=>{console.log("OsTextView: 组件已挂载")})),E((()=>a.visible),(n=>{console.log("OsTextView: visible变化为:",n),n?x((()=>{A()})):(l&&(clearInterval(l),l=null),o.value=!1,i.value="")})),E((()=>a.text),(n=>{console.log("OsTextView: text变化为:",n),a.visible&&x((()=>{A()}))})),k((()=>{l&&(clearInterval(l),l=null)})),(e,t)=>n.visible?(r(),c("div",{key:0,class:"os-text-container",onClick:V},[h("div",fn,[I(f(i.value)+" ",1),o.value?(r(),c("span",$n,"|")):$("",!0)]),!o.value&&n.waitingForRestart?(r(),c("div",{key:0,class:"restart-button",onClick:d}," 重新开始 ")):o.value||n.isEnding?$("",!0):(r(),c("div",Cn," 点击继续 "))])):$("",!0)},__scopeId:"data-v-afe1566c"};const kn={key:0,class:"ending-modal-overlay"},In={class:"ending-modal"},xn={class:"ending-content"},wn={class:"ending-title"},Qn={class:"ending-description"},Bn={__name:"EndingModal",props:{visible:{type:Boolean,default:!1},endingType:{type:String,default:null}},setup(n){const e=n,t=m(),s=K(),a={good:{title:"好结局：如常的黎明",description:'你成功地扮演了"过去的我"，用稳健和理智安抚了她，将所有异常都隔绝在她感知之外。她错过了陌生人绝望的警告，父母的短暂失联也被解释为一场误会。这个新年夜的危机似乎过去了。然而，楼下的阴影只是暂时退去，那个偏执的凝视，将在下一个黑夜，以更近的距离，重新包裹她。你为她守护了一个虚假的黎明。'},normal:{title:"普通结局：未知的敲门声",description:'你的选择充满了矛盾，既没能给她足够的安全感，又激起了她无尽的恐惧。父母的失联、陌生人的警告、你的突然冷漠，一切都将她推向崩溃的边缘。你选择抽身离开，将她独自留在被未知包裹的房间里。几分钟后，她的房门被敲响了。她不知道门外是谁。是来"保护"你的我？是来警示她的陌生人？还是......终于从房间里出来的"父母"？这个新年，她将永远活在无尽的猜测和恐惧之中。'},true:{title:"真结局：我的金丝雀",description:'你遵从了被替换后的本能，用最偏执的方式回应了她的依赖和你的爱。你强迫她打开了陌生人最后的警告，并用言语将其歪曲为无稽之谈，彻底切断了她与外界的联系。当门锁转动的那一刻，她才明白，楼下的陌生人、电话里的爱人、和即将进入她房间的"你"，是同一个存在。至于她的父母……或许他们从一开始就不在，或许他们再也不会醒来。从这个新年开始，她将成为你一个人的金丝雀，被囚禁在由你亲手打造的、名为"爱"的牢笼里，永远无法逃离。你们，终于"永远在一起"了。'}},i=w((()=>e.endingType&&a[e.endingType]?a[e.endingType].title:"结局")),o=w((()=>e.endingType&&a[e.endingType]?a[e.endingType].description:"游戏结束")),l=()=>{s.resetGame(),s.startGame(),t.push("/")},u=()=>{t.push("/")};return(e,t)=>n.visible?(r(),c("div",kn,[h("div",In,[h("div",xn,[h("h2",wn,f(i.value),1),h("div",Qn,f(o.value),1)]),h("div",{class:"ending-actions"},[h("button",{class:"restart-button",onClick:l},"重新开始"),h("button",{class:"back-to-main-button",onClick:u},"返回主页面")])])])):$("",!0)},__scopeId:"data-v-628fdd4c"};var On="/src/assets/characters/stranger/avatar.png";var bn="/src/assets/characters/haiming/avatar.png";var Fn="/src/assets/characters/mother/avatar.png";var Dn="/src/assets/characters/me/avatar.png";const Hn=["src"],Kn={class:"bubble-content"},Mn={key:0,class:"text-content"},Gn={key:1,class:"image-content"},Rn=["src"],Un={key:2,class:"emoji-content"},Pn=["src"],Jn={class:"bubble-content"},qn={key:0,class:"text-content"},_n={key:1,class:"image-content"},Ln=["src"],jn={key:2,class:"emoji-content"},Yn=["src"],Wn=["src"],Nn={key:0,class:"timestamp"},Xn={__name:"ChatBubble",props:{message:{type:Object,required:!0},characterProfiles:{type:Object,required:!0},showTimestamp:{type:Boolean,default:!1}},setup(n){const e=n,t=w((()=>"我"===e.message.speaker||"me"===e.message.speaker)),s=w((()=>{const n=e.characterProfiles[e.message.speaker];return n?n.avatar:"/assets/characters/default_avatar.png"})),a=w((()=>{if(!e.message.timestamp)return"";return new Date(e.message.timestamp).toLocaleTimeString(navigator.language,{hour:"2-digit",minute:"2-digit",hour12:!1})}));return(e,i)=>(r(),c("div",{class:T(["message-container",{"sent-by-me":t.value}])},[h("div",{class:T(["bubble-wrapper",{"sent-by-me":t.value}])},[t.value?(r(),c(v,{key:1},[h("div",Jn,["text"===n.message.type?(r(),c("div",qn,f(n.message.content),1)):$("",!0),"image"===n.message.type?(r(),c("div",_n,[h("img",{src:n.message.src,alt:"image content",class:"message-image"},null,8,Ln)])):$("",!0),"emoji"===n.message.type?(r(),c("div",jn,[h("img",{src:n.message.src,alt:"emoji",class:"message-emoji"},null,8,Yn)])):$("",!0)]),h("img",{src:s.value,class:"avatar",alt:"avatar"},null,8,Wn)],64)):(r(),c(v,{key:0},[h("img",{src:s.value,class:"avatar",alt:"avatar"},null,8,Hn),h("div",Kn,["text"===n.message.type?(r(),c("div",Mn,f(n.message.content),1)):$("",!0),"image"===n.message.type?(r(),c("div",Gn,[h("img",{src:n.message.src,alt:"image content",class:"message-image"},null,8,Rn)])):$("",!0),"emoji"===n.message.type?(r(),c("div",Un,[h("img",{src:n.message.src,alt:"emoji",class:"message-emoji"},null,8,Pn)])):$("",!0)])],64))],2),n.showTimestamp?(r(),c("div",Nn,f(a.value),1)):$("",!0)],2))},__scopeId:"data-v-f15d8588"};const Zn={class:"system-message-wrapper"},zn={class:"system-text"},ne={__name:"SystemMessage",props:{text:{type:String,required:!0}},setup:n=>(e,t)=>(r(),c("div",Zn,[h("span",zn,f(n.text),1)])),__scopeId:"data-v-31366c36"};const ee={__name:"OptionButton",props:{text:{type:String,required:!0}},emits:["select"],setup:n=>(e,t)=>(r(),c("button",{class:"option-button",onClick:t[0]||(t[0]=n=>e.$emit("select"))},f(n.text),1)),__scopeId:"data-v-0ccd46c0"};const te={class:"header"},se={key:0,class:"options-panel"},ae={__name:"ConversationView",setup(n){const e=Q(),t=m(),s=K(),a=new en,{initAudio:i,playMessageSendSound:o,startBgm:u,stopBgm:A,updateBgmBasedOnSan:V}=yn(),g=p(null),k=p("girlfriend"),B={girlfriend:{name:"女友",script:'// ---------------------------------------------------\n// 女友线：楼下的凝视 (最终·设定补完版)\n// 关联角色：陌生人 (实际为警告者)\n// 游戏时间：23:30 - 00:30\n// 结局分支：普通结局、好结局、真结局\n// ---------------------------------------------------\n\n$23:30$\n\n女友: 在吗在吗在吗？\n\n女友: 亲爱的！\n\n女友: 除夕夜倒计时开始啦！\n\n女友: 你那边怎么样？\n\n女友: 是不是也像我这边一样，窗外噼里啪啦的都是烟花声？\n\n[options]:\n1. 嗯，听见了，很热闹。\n2. 早就在等你的消息了。\n3. 外面很吵，但心里很静，因为在想你。\n\n// 选项1 -> 跳转至 $23:31$\n// 选项2 -> 跳转至 $23:31_2$\n// 选项3 -> 跳转至 $23:31_3$\n$23:31$\n\n我: 嗯，听见了，很热闹。\n\n女友: 是吧是吧！\n\n女友: 我刚刚在阳台上看了一会儿，夜空被照得好亮。\n\n女友: 就是有点冷，我赶紧缩回来了。\n\n女友: 你穿得暖和吗？别把自己冻感冒了。\n<SendEmoji: E3>\n// -> 跳转至 $23:32$\n\n$23:31_2$\n\n我: 早就在等你的消息了。\n\n女友: 嘿嘿，我就知道。\n\n女友: 我也是，忙完家里的事就第一时间找你了。\n\n女友: 我刚刚在阳台上看了一会儿烟花，特别好看。\n\n女友: 就是有点冷，赶紧缩回来了。你穿得暖和吗？\n<SendEmoji: E3>\n// -> 跳转至 $23:32$\n\n$23:31_3$\n<SanEffect: -20>\n我: 外面很吵，但心里很静，因为在想你。\n\n女友: 你总是这么会说话。\n\n女友: 我也是，刚刚看烟花的时候就想，要是你在身边一起看该多好。\n\n女友: 外面好冷，你可要穿暖和点。\n<SendEmoji: E3>\n// -> 跳转至 $23:32$\n\n$23:32$\n\n女友: 对了，你晚饭吃得好吗？\n\n女友: 自己一个人在老房子那边，肯定又是随便对付一下就算了吧？\n\n女友: 我给你点的外卖收到了吗？\n\n女友: 算着时间应该差不多到了。\n\n[options]:\n1. 收到了！是你点的那家酸菜鱼，太棒了！\n2. 还没，不急。\n3. 让你别花钱了。\n\n// 选项1 -> 跳转至 $23:33$\n// 选项2 -> 跳转至 $23:33_2$\n// 选项3 -> 跳转至 $23:33_3$\n$23:33$\n\n<SanEffect: -20>\n我: 收到了！是你点的那家酸菜鱼，太棒了！\n\n女友: 嘻嘻，那就好！\n\n女友: 我就知道你肯定会喜欢的。\n\n女友: 大过节的，总得吃点好的。\n\n女友: 快吃吧，别凉了。\n// -> 跳转至 $23:35$\n\n$23:33_2$\n\n我: 还没，不急。\n\n女友: 还没到吗？那可能外卖小哥路上有点堵。\n\n女友: 你饿不饿啊？要不要自己先找点东西垫一下？\n\n我: 不用，我等你消息就不饿了。\n\n女友: 你呀……好吧，那我们聊着天等。\n// -> 跳转至 $23:35$\n\n$23:33_3$\n<SanEffect: -10>\n我: 让你别花钱了。\n\n女友: 哎呀，这又没什么。\n\n女友: 我不想你一个人过节还吃得那么随便嘛。\n\n女友: 这是我的心意，你不许拒绝。\n\n女友: 到了之后一定要趁热吃，知道吗？\n// -> 跳转至 $23:35$\n\n$23:35$\n\n女友: 我这边嘛，我爸妈做了一大桌子菜。\n\n女友: 拍张照给你看看，馋死你。\n<ImageSend: new_year_feast.jpg>\n\n我: 很丰盛。替我跟叔叔阿姨问好。\n\n女友: 早就替你问过啦。我爸还喝了点酒，现在跟我妈在客厅看电视呢。\n\n女友: 唉……就是有点想你。\n\n女友: 如果此刻你在我身边，那就真的完美了。\n\n女友: 幸好你住得也不远，就在那边的老城区。\n\n女友: 走路过来也就半小时吧？想到这个，就感觉我们其实离得很近。\n\n我: 是啊，很近。\n\n女友: 不聊这个啦，我先去阳台收一下衣服，马上回来。\n\n我: 好。\n// -> 跳转至 $23:40$\n\n$23:40$\n\n女友: 亲爱的。\n\n我: 嗯？\n\n<SanEffect: -10>\n女友: 我有点害怕。\n\n女友: 窗外好像有人。\n\n女友: 我刚去阳台，看到楼下花坛的阴影里站着一个人。\n女友: 一动不动的，看着有点吓人。\n女友: 我刚想跟我爸妈说，他们就回房间休息了，说年纪大了熬不住。\n女友: 我一个人在客厅，心里还是有点毛毛的。\n// -> 跳转至 $23:43$\n\n// $高San值分支$\n$23:43$\n\n我: 别怕，有我在。\n\n女友: 嗯……\n\n我: 把窗帘拉上，就当他不存在。\n\n[options]:\n1. 别想了，我们聊点开心的。比如年后去哪玩？\n2. 那我陪你一起"监视"他，看看他到底想干什么。\n3. 打开窗户。\n\n// 选项1 -> 跳转至 $23:44_1$\n// 选项2 -> 跳转至 $23:44_2$\n// 选项3 -> 跳转至 $23:44_3$\n\n$23:44_1$\n\n我: 别想了，我们聊点开心的。比如年后去哪玩？\n\n女友: 嗯……好吧。\n\n女友: 听你的，不想那些了。\n\n女友: 年后呀……我想去海边！我们好久没去海边了。\n\n我: 好，那就去海边。我来查攻略，订酒店。\n\n女友: 真的？太棒了！我想穿那条去年买的蓝色长裙。\n\n我: 记得。你穿上一定很好看。\n\n女友: 我们还要去吃海鲜大餐，要那种特别大的螃蟹！\n\n我: 都听你的。\n\n女友: 嘻嘻，跟你聊天，什么烦恼都没有了。\n// -> 跳转至 $00:05$\n\n// 选项2 -> 普通结局路线\n$23:44_2$\n\n我: 那我陪你一起“监视”他，看看他到底想干什么。\n\n女友: 啊？这样好吗……我有点怕。\n\n我: 有我在，你怕什么。\n\n我: 透过窗帘缝隙看，他发现不了。\n\n女友: ……好吧。那……那我悄悄看。\n\n女友: 他还在那儿，真的没动。\n\n我: 看清楚长相吗？\n\n女友: 看不清，太黑了。只能看到一个轮廓。\n\n女友: 亲爱的，我心跳得好快。\n\n我: 继续看。别出声。\n// -> 跳转至 $00:10$\n\n// 选项3 -> 真结局路线\n$23:44_3$\n\n我: 打开窗户。\n\n<SanEffect: -25>\n女友: ……什么？\n\n我: 把窗户打开一条缝。\n\n女友: 为什么？外面很冷，而且……\n\n我: 我想听你的声音更清楚一点。\n\n我: 让他也听见。\n\n女友: 你在说什么……我听不懂……你好吓人……\n\n我: 听话。打开它。\n\n女友: ……我……我不敢……\n\n我: 你必须这么做。\n// -> 跳转至 $00:15$\n\n$低San值分支$\n$23:43$\n\n我: 别怕，我在。\n\n女友: 嗯……有你陪着我好多了。\n\n[options]:\n1. 回房间，锁好门，拉上窗帘。不要再看，不要再想。\n2. 告诉我他的特征。身高，体型，衣着颜色。\n3. 锁好门。等我。\n\n// 选项1 -> 跳转至 $23:44_4$\n// 选项2 -> 跳转至 $23:44_5$\n// 选项3 -> 跳转至 $23:44_6$\n\n$23:44_4$\n\n我: 回房间，锁好门，拉上窗帘。不要再看，不要再想。\n\n女友: 嗯，好。\n\n女友: 我听你的，我现在回房间了。\n\n女友: 门已经反锁了，窗帘也拉得严严实实。\n\n我: 很好。现在那里是绝对安全的。\n\n女友: 嗯，看不见外面，心里果然踏实多了。\n\n我: 我们聊点别的。你最喜欢的那部电影，最近出续集了。\n\n女友: 真的吗！太好了！我们过完年就去看！\n// -> 跳转至 $00:05$\n\n// 选项2 -> 普通结局路线\n$23:44_5$\n\n我: 告诉我他的特征。身高，体型，衣着颜色。\n\n<SanEffect: -15>\n女友: 我……我尽量看。\n\n女友: 他很高，很瘦。穿着深色的衣服，好像是黑色的外套。\n\n我: 还有呢。\n\n女友: 没……没有了，看不清了。\n\n女友: 亲爱的，问这个干什么？你不会是怀疑……\n\n我: 没什么。知己知彼。\n\n女友: 天哪，他好像抬头了！就在看我这个方向！我不敢看了！\n// -> 跳转至 $00:10$\n\n// 选项3 -> 真结局路线\n$23:44_6$\n\n我: 锁好门。等我。\n\n<SanEffect: -30>\n女友: ！\n\n女友: 你要过来？\n\n我: 对。\n\n女友: 可是现在这么晚……\n\n我: 待在原地。不要出声。等我。\n\n女友: 嗯！嗯！好！我等你！你路上小心！\n\n女友: 那个……楼下的人……他好像走了。\n\n我: 我知道。\n\n<SanEffect: -15>\n女友: ……？\n\n我: 我出发了。\n// -> 跳转至 $00:15$\n\n---\n### **【结局收束点与结局简述】**\n\n// $好结局收束点$\n$00:05$\n\n女友: 新年快乐，亲爱的！\n\n我: 新年快乐。\n\n女友: 刚刚倒数的时候，我许的愿望就是希望我们的旅行计划能顺顺利利！\n\n我: 一定会。\n\n女友: 嗯！跟你聊了这么久，之前那点害怕早就飞到九霄云外了。\n\n女友: 有你真好。对了，我爸妈刚刚从房间出来了，问我怎么还没睡，嘿嘿。\n\n女友: ……对了，刚才有个叫‘.’的陌生人想加我，我没通过。估计是诈骗的，现在骗子真是无孔不入。\n\n我: 不用理会。有我在，没人能骗得了你。\n\n女友: 嗯！我们继续聊我们的小窝该怎么布置……\n\n女友: 不知不觉都聊到这么晚了。感觉只要能这样跟你说话，我就什么都不怕了。\n\n我: 我会一直在。\n\n女友: 嗯！我相信你。等天亮了，我就能见到你了，对吧？\n\n我: 对。天亮就见。\n\n<Ending: good>\n**[好结局：如常的黎明]**\n你成功地扮演了“过去的我”，用稳健和理智安抚了她，将所有异常都隔绝在她感知之外。她错过了陌生人绝望的警告，父母的短暂失联也被解释为一场误会。这个新年夜的危机似乎过去了。然而，楼下的阴影只是暂时退去，那个偏执的凝视，将在下一个黑夜，以更近的距离，重新包裹她。你为她守护了一个虚假的黎明。\n\n---\n\n$普通结局收束点$\n$00:10$\n\n女友: 新年快乐……亲爱的。\n\n我: 新年快乐。\n\n女友: 我……我一点也开心不起来。那个人到底是谁……我爸妈房间还是没动静……\n\n我: 一个过客。一件小事。\n\n女友: 可是……\n\n女友: 天哪！有个陌生人加我，发了一张很诡异的白马照片！他想告诉我什么？亲爱的，你说这会不会跟楼下那个人有关系？！\n\n我: 不要把无关的事情联系在一起。\n\n女友: 可是我害怕！你不安慰我吗？\n\n我: 安静。\n\n女友: ……\n\n我: 时间不早了。\n\n女友: 你要挂了吗？别挂好不好，我怕……\n\n<OS_Text> 你挂断了电话。 </OS_Text>\n\n<OS_Text> 电话那头传来女孩压抑的啜泣声，和反复拨打电话的忙音。 </OS_Text>\n\n<OS_Text> 你没有再接。 </OS_Text>\n\n<Ending: normal>\n**[普通结局：未知的敲门声]**\n**你的选择充满了矛盾，既没能给她足够的安全感，又激起了她无尽的恐惧。父母的失联、陌生人的警告、你的突然冷漠，一切都将她推向崩溃的边缘。你选择抽身离开，将她独自留在被未知包裹的房间里。几分钟后，她的房门被敲响了。她不知道门外是谁。是来“保护”你的我？是来警示她的陌生人？还是……终于从房间里出来的“父母”？这个新年，她将永远活在无尽的猜测和恐惧之中。**\n\n---\n\n$真结局收束点$\n$00:15$\n\n女友: 你……你真的要来吗？我爸妈他们……\n\n我: 我在路上了。别管他们。\n\n女友: 可是……\n\n<OS_Text> 你收到一条来自“陌生人”的消息。 </OS_Text>\n\n我: 收到一张照片吗。\n\n女友: ！你怎么知道！\n\n我: 点开它。看看那个想从我身边把你夺走的人，发了什么无聊的东西。\n\n<SanEffect: -15>\n女友: 不……我不敢……这匹白马到底是什么意思……\n\n我: 这是命令。点开。\n\n女友: (带着哭腔) 我……我点了……它只是一张图……\n<ImageInteraction: white_horse.jpg>\n\n我: 看到了吗？毫无意义。只有我，才是真实的。\n\n女友: 我好像……能听到楼道里的脚步声了。\n\n女友: 是你吗？你真的来了？\n\n我: 我说过，我会来的。\n\n女友: 你是怎么上来的？我没听到门禁的声音啊……\n\n<SanEffect: -30>\n我: 总有办法的。为了见到你。\n\n女友: ……你快敲门吧，我已经等不及了。\n\n我: 不用。\n\n女友: ？\n\n我: 我有钥匙。\n\n女友: 钥匙？我的备用钥匙不是……\n// -> 跳转至 $00:30$\n$00:30$\n\n<OS_Text> 电话被挂断了。 </OS_Text>\n<OS_Text> 寂静的房间里，响起了钥匙插入锁芯的、清晰的转动声。 </OS_Text>\n<ImageSend: door_opening.jpg> // (一张门缝逐渐变大，门外站着一个看不清脸的黑色人影的图片)\n<OS_Text> “宝贝。” </OS_Text>\n<OS_Text> “我来了。” </OS_Text>\n\n<Ending: true>\n**[真结局：我的金丝雀]**\n**你遵从了被替换后的本能，用最偏执的方式回应了她的依赖和你的爱。你强迫她打开了陌生人最后的警告，并用言语将其歪曲为无稽之谈，彻底切断了她与外界的联系。当门锁转动的那一刻，她才明白，楼下的陌生人、电话里的爱人、和即将进入她房间的“你”，是同一个存在。至于她的父母……或许他们从一开始就不在，或许他们再也不会醒来。从这个新年开始，她将成为你一个人的金丝雀，被囚禁在由你亲手打造的、名为“爱”的牢笼里，永远无法逃离。你们，终于“永远在一起”了。**\n\n',avatar:R},stranger:{name:"陌生人",script:"// ---------------------------------------------------\n// 陌生人线：窥伺之人 (最终·定稿)\n// 关联角色：女友 (背景存在)\n// 游戏时间：23:30 - 00:30\n// 结局分支：普通结局、好结局、真结局\n// ---------------------------------------------------\n\n$23:30$\n\n陌生人: 你女朋友家楼下，有个人。\n\n$23:31$\n\n我: 你是谁？你怎么知道那是我女朋友家？\n\n陌生人: 我只是路过。看到有个人一直站在这里，一动不动。\n\n我: 除了你还有别人？你为什么不报警？\n\n陌生人: 我不确定他想做什么。也许只是在等人。\n\n$23:40$\n\n我: 他还在吗？\n\n陌生人: 还在。像一尊雕塑。\n\n我: 你能描述一下他吗？\n\n陌生人: 太黑了，看不清。但我感觉……很不舒服。\n\n[options]:\n1. 你到底想说什么？别卖关子。\n2. 你能不能帮我个忙？盯紧他，有任何异动立刻告诉我。\n3. 离那里远点，你也是。\n\n// 选项1 -> San值降低，触发白马事件\n$23:50$\n\n我: 你到底想说什么？别卖关子。\n\n<SanEffect: -10>\n陌生人: 我只是想确认一下。\n\n我: 确认什么？\n\n陌生人: ……等一下。前面的路灯很亮。\n\n陌生人: 那个影子……好像动了……不……\n\n陌生人: 那是什么？\n\n我: 你看到了什么？\n\n陌生人: 我看到了一匹白马的影子，只有一瞬间。\n\n<SanEffect: -20>\n我: 你喝多了？\n\n陌生人: [图片]\n陌生人: 这是我刚刚拍到的。\n// -> 跳转至 [共同剧情A]\n\n// 选项2 & 3 -> 剧情平稳推进\n$23:50$\n\n我: [选择选项2或3的对话]\n\n陌生人: 我会的。/ 我知道。\n\n陌生人: 他好像没打算离开。\n\n我: 该死。\n// -> 跳转至 [共同剧情A]\n\n// [共同剧情A]\n$23:58$\n\n陌生人: 她好像出来了，在阳台上。\n\n我:！\n\n陌生人: 楼下那个人……好像在笑。\n\n$00:00$\n\n陌生人: 新年快乐。天上的烟花，把这里照得很亮。\n\n我: 别说废话，他有没有做什么？！\n\n陌生人: 烟花……照亮了他的脸。\n\n陌生人: 也照亮了你的。\n\n<OS_Text> 你愣住了，你所在的房间没有任何烟花的光亮。 </OS_Text>\n<OS_Text> 记忆的碎片猛然涌入，车祸、河边、冰冷的空气…… </OS_Text>\n<OS_Text> 你不在你的旧房子里。你正站在她家楼下的街道上。 </OS_Text>\n\n[options]: // 身份揭示后的选项\n1. 你……到底是谁？ (导向普通结局)\n2. 那匹马……是什么？ (导向好结局)\n3. 你好像知道得太多了。 (导向真结局)\n\n// 选项1 -> 普通结局路线\n$00:05$\n\n我: 你……到底是谁？\n\n陌生人: 一个试图阻止你的人。\n\n我: [删除好友]\n// -> 跳转至 [普通结局收束点]\n\n// 选项2 -> 好结局路线\n$00:05$\n\n我: 那匹马……是什么？\n\n陌生人: 我不知道。但我知道，你不是人。\n\n我: ……\n\n陌生人: 我会离开。但她有权知道，在楼下看着她的，到底是什么东西。\n\n我: 你威胁我？\n\n陌生人: 我只是在陈述事实。\n// -> 跳转至 [好结局收束点]\n\n// 选项3 -> 真结局路线 (衔接强化版)\n$00:05$\n\n我: 你好像知道得太多了。\n\n<SanEffect: -20>\n陌生人: 我还知道，你根本不是想保护她。\n\n陌生人: 你在享受她的恐惧。那种无助和不安，让你感到满足。\n\n我: 你看，就是因为有你这样的窥伺者，才让她如此不安。\n\n我: 现在，我得上去安抚她了。\n\n陌生人: 站住！不准过去！\n\n我: [删除好友]\n// -> 跳转至 [真结局收束点]\n\n---\n### **【结局收束点与结局简述】**\n\n// [好结局收束点]\n$00:30$\n<OS_Text> 那个窥探者离开了，你目送着他消失在街角。 </OS_Text>\n<OS_Text> 你知道他会做什么，但这不重要了。 </OS_Text>\n<OS_Text> 因为在你打开门后，任何外部信息都将失去意义。 </OS_Text>\n\n**[好结局：最后的警告]**\n你的非人本质被揭露，但对方并未知晓你更深层的扭曲动机。你成功地将他吓退，他则选择用自己的方式——将那张诡异的白马照片发给你的女友，作为最后的警告。这为你接下来的计划增添了一丝小小的变数，但大局未变。舞台的大幕，依然会为你拉开。\n\n---\n\n// [普通结局收束点]\n$00:30$\n<OS_Text> 你切断了联系，无视了远处的那个影子。 </OS_Text>\n<OS_Text> 你径直走向单元门，身后传来了急促的脚步声。 </OS_Text>\n<OS_Text> 一个确定的阻碍，需要被物理移除。 </OS_Text>\n\n**[普通结局：暴露的执行者]**\n身份的暴露没有阻止你，反而让你抛弃了最后的伪装。你决定强行推进计划，即使窥伺者就在身后。当你打开门时，将要面对的不仅仅是目标，还有一个誓死要保护她的闯入者。事情的发展，已经完全脱离了你的掌控。\n\n---\n\n// [真结局收束点 (衔接强化版)]\n$00:30$\n<OS_Text> 你切断通讯，径直走向单元门，身后传来他追赶的脚步声。 </OS_Text>\n<OS_Text> 你用一种非人的速度登上三楼，打开302的门，闪入一旁的阴影中。 </OS_Text>\n<OS_Text> 他紧随而至，毫不犹豫地冲进了那扇为他敞开的、通往虚无的门。 </OS_Text>\n<PhoneVibrate>\n陌生人: 这是哪里？里面是空的！你人呢？开门！\n\n我: 这正是你的愿望，不是吗？\n\n陌生人: 什么愿望？你这个疯子！快放我出去！\n\n我: 你才是真正的窥伺者。\n\n陌生人: 你到底想干什么！救命！\n\n我: 我现在，正在合理地进行正当防卫。\n<SoundEffect: Generic_Scream.wav>\n\n**[真结局：正当防卫]**\n他不仅看到了你的外壳，还看穿了你的核心。你用“安抚她”作为借口，迫使他在情急之下去阻止一场即将发生的“悲剧”。最终，你利用他的正义感，为他设下了一个完美的逻辑陷阱，将“窥伺者”的罪名嫁祸于他，以“正当防卫”的名义，清除了舞台上最后一点杂音。",avatar:On},haiming:{name:"海明",script:"// ---------------------------------------------------\n// 海明线：兄弟的疑惑\n// 关联角色：无\n// 游戏时间：23:30 - 00:30\n// 结局分支：信任结局、怀疑结局\n// ---------------------------------------------------\n\n$23:30$\n\n海明: 兄弟，在吗？\n\n海明: 新年快乐！\n\n海明: 怎么最近都没见你出来玩？\n\n海明: 是不是又在忙什么？\n\n海明: 对了，可欣最近怎么样？你们俩还好吗？\n\n[options]:\n1. 挺好的，最近有点忙。\n2. 还行，就是有点累。\n3. 别问了，我现在不想说话。\n\n// 选项1: [挺好的，最近有点忙。] - 正常回应\n$23:31$\n\n我: 挺好的，最近有点忙。\n\n海明: 忙什么呢？要不要兄弟帮忙？\n\n海明: 对了，我们几个兄弟打算明天聚一聚，你要不要来？\n\n海明: 大家都挺想你的。\n\n// -> 跳转至 [兄弟聚会]\n\n// 选项2: [还行，就是有点累。] - 疲惫回应\n$23:31$\n\n我: 还行，就是有点累。\n\n海明: 怎么了？是不是工作压力太大了？\n\n海明: 要是累了就休息休息，别把自己搞垮了。\n\n海明: 对了，我们明天聚一聚，你来的话我开车接你。\n\n// -> 跳转至 [兄弟聚会]\n\n// 选项3: [别问了，我现在不想说话。] - 烦躁回应\n$23:31$\n\n我: 别问了，我现在不想说话。\n\n海明: 怎么了？发这么大火？\n\n海明: 是不是遇到什么事了？跟兄弟说说，说不定我能帮你。\n\n海明: 你这样我很担心啊。\n\n// -> 跳转至 [兄弟关心]\n\n// [兄弟聚会]\n$23:32$\n\n海明: 那说好了，明天下午三点，老地方见。\n\n海明: 对了，可欣也一起来吧？\n\n海明: 大家都想见见她。\n\n[options]:\n1. 好的，我们一起去。\n2. 她可能没时间，我自己去。\n3. 再说吧，我现在不确定。\n\n// 选项1: [好的，我们一起去。] - 积极回应\n$23:33$\n\n我: 好的，我们一起去。\n\n海明: 太好了！那明天见。\n\n海明: 对了，你最近有没有觉得自己有点不对劲？\n\n海明: 我总觉得你最近怪怪的。\n\n// -> 跳转至 [兄弟疑惑]\n\n// 选项2: [她可能没时间，我自己去。] - 犹豫回应\n$23:33$\n\n我: 她可能没时间，我自己去。\n\n海明: 这样啊，那也行。\n\n海明: 对了，你最近是不是遇到什么事了？\n\n海明: 我感觉你最近好像变了一个人。\n\n// -> 跳转至 [兄弟疑惑]\n\n// 选项3: [再说吧，我现在不确定。] - 不确定回应\n$23:33$\n\n我: 再说吧，我现在不确定。\n\n海明: 好吧，那等你确定了告诉我。\n\n海明: 对了，你最近有没有觉得身体不舒服？\n\n海明: 我看你最近脸色不太好。\n\n// -> 跳转至 [兄弟疑惑]\n\n// [兄弟关心]\n$23:32$\n\n海明: 兄弟，到底怎么了？\n\n海明: 是不是和可欣吵架了？\n\n海明: 还是工作上遇到麻烦了？\n\n海明: 不管是什么事，兄弟都在这儿。\n\n[options]:\n1. 没什么，就是有点累。\n2. 我没事，你别管了。\n3. 我……我好像出问题了。\n\n// 选项1: [没什么，就是有点累。] - 轻描淡写\n$23:33$\n\n我: 没什么，就是有点累。\n\n海明: 累了就好好休息，别硬撑着。\n\n海明: 对了，我们明天聚一聚，你来吧？\n\n海明: 放松放松心情。\n\n// -> 跳转至 [兄弟聚会]\n\n// 选项2: [我没事，你别管了。] - 拒绝关心\n$23:33$\n\n我: 我没事，你别管了。\n\n海明: 好吧，那你好好休息。\n\n海明: 要是有什么事，随时给我打电话。\n\n海明: 兄弟永远支持你。\n\n// -> 跳转至 [怀疑结局]\n\n// 选项3: [我……我好像出问题了。] - 坦诚相告\n$23:33$\n\n我: 我……我好像出问题了。\n\n海明: 什么问题？你说啊。\n\n海明: 是不是身体不舒服？要不要我陪你去医院？\n\n海明: 兄弟，你别吓我。\n\n// -> 跳转至 [信任结局]\n\n// [兄弟疑惑]\n$23:35$\n\n海明: 兄弟，你最近到底怎么了？\n\n海明: 我总觉得你最近怪怪的。\n\n海明: 是不是遇到什么事了？\n\n海明: 跟兄弟说说，说不定我能帮你。\n\n[options]:\n1. 真的没什么，你想多了。\n2. 可能是最近压力太大了。\n3. 我……我好像不是我了。\n\n// 选项1: [真的没什么，你想多了。] - 否认\n$23:36$\n\n我: 真的没什么，你想多了。\n\n海明: 好吧，可能是我想多了。\n\n海明: 那明天聚会，你一定要来啊。\n\n海明: 大家都挺想你的。\n\n// -> 跳转至 [信任结局]\n\n// 选项2: [可能是最近压力太大了。] - 解释\n$23:36$\n\n我: 可能是最近压力太大了。\n\n海明: 压力大就放松放松，别把自己搞垮了。\n\n海明: 明天聚会，我们不醉不归！\n\n海明: 好好放松一下。\n\n// -> 跳转至 [信任结局]\n\n// 选项3: [我……我好像不是我了。] - 暗示\n$23:36$\n\n我: 我……我好像不是我了。\n\n海明: 你在说什么？别吓我。\n\n海明: 是不是最近没休息好？\n\n海明: 明天我陪你去医院看看吧。\n\n// -> 跳转至 [信任结局]\n\n// [信任结局]\n$00:00$\n\n海明: 新年快乐，兄弟！\n\n海明: 不管发生什么事，兄弟永远支持你。\n\n海明: 明天见，咱们不醉不归！\n\n$00:30$\n\n海明: 时间不早了，早点休息吧。\n\n海明: 明天我来接你。\n\n海明: 记住，兄弟永远在你身边。\n\n**[信任结局：兄弟的支持]**\n你选择了信任海明，虽然你没有完全告诉他真相，但他依然选择相信你，支持你。这是一个温暖的结局，展现了兄弟之间的深厚情谊。\n\n// [怀疑结局]\n$00:00$\n\n海明: 新年快乐。\n\n海明: 虽然你不想说，但我还是很担心你。\n\n海明: 要是有什么事，记得告诉我。\n\n$00:30$\n\n海明: 时间不早了。\n\n海明: 不管你遇到什么事，我都希望你能挺过去。\n\n海明: 兄弟，保重。\n\n**[怀疑结局：兄弟的担忧]**\n你选择了疏远海明，他虽然感到疑惑和担忧，但还是选择尊重你的决定。这是一个略带遗憾的结局，但也展现了兄弟之间的理解和尊重。",avatar:bn},mother:{name:"母亲",script:"// ---------------------------------------------------\n// 母亲线：慈母的牵挂\n// 关联角色：无\n// 游戏时间：23:30 - 00:30\n// 结局分支：回家结局、不回家结局\n// ---------------------------------------------------\n\n$23:30$\n\n母亲: 儿子，在吗？\n\n母亲: 新年快乐！\n\n母亲: 你什么时候回家啊？\n\n母亲: 我和你爸都很想你。\n\n母亲: 家里做了你最喜欢的红烧肉，就等你回来了。\n\n[options]:\n1. 妈，我很快就回家。\n2. 妈，我今年可能回不去了。\n3. 别催了，我现在很烦。\n\n// 选项1: [妈，我很快就回家。] - 安慰回应\n$23:31$\n\n我: 妈，我很快就回家。\n\n母亲: 太好了！我和你爸都等着你呢。\n\n母亲: 路上注意安全，别着急。\n\n母亲: 红烧肉我给你留着，热乎的。\n\n// -> 跳转至 [回家准备]\n\n// 选项2: [妈，我今年可能回不去了。] - 拒绝回应\n$23:31$\n\n我: 妈，我今年可能回不去了。\n\n母亲: 怎么了？是不是工作太忙了？\n\n母亲: 再忙也要回家过年啊。\n\n母亲: 我和你爸都一年没见你了。\n\n// -> 跳转至 [母亲担忧]\n\n// 选项3: [别催了，我现在很烦。] - 烦躁回应\n$23:31$\n\n我: 别催了，我现在很烦。\n\n母亲: 怎么了？是不是遇到什么事了？\n\n母亲: 跟妈说说，妈给你出出主意。\n\n母亲: 不管发生什么事，家永远是你的后盾。\n\n// -> 跳转至 [母亲关心]\n\n// [回家准备]\n$23:32$\n\n母亲: 儿子，你现在在哪里？\n\n母亲: 大概什么时候能到家？\n\n母亲: 我让你爸去接你吧？\n\n母亲: 路上车多，注意安全。\n\n[options]:\n1. 不用了，我自己打车回去。\n2. 好的，让爸来接我吧。\n3. 妈，我可能还是回不去了。\n\n// 选项1: [不用了，我自己打车回去。] - 独立回应\n$23:33$\n\n我: 不用了，我自己打车回去。\n\n母亲: 那也行，路上小心。\n\n母亲: 到家了给妈打个电话。\n\n母亲: 我给你留着门。\n\n// -> 跳转至 [回家结局]\n\n// 选项2: [好的，让爸来接我吧。] - 依赖回应\n$23:33$\n\n我: 好的，让爸来接我吧。\n\n母亲: 好的，我这就给你爸打电话。\n\n母亲: 你在原地等着，别乱走。\n\n母亲: 很快就到。\n\n// -> 跳转至 [回家结局]\n\n// 选项3: [妈，我可能还是回不去了。] - 反悔回应\n$23:33$\n\n我: 妈，我可能还是回不去了。\n\n母亲: 为什么？是不是发生什么事了？\n\n母亲: 你跟妈说实话，是不是遇到什么困难了？\n\n母亲: 不管是什么事，妈都能帮你。\n\n// -> 跳转至 [不回家结局]\n\n// [母亲担忧]\n$23:32$\n\n母亲: 儿子，是不是遇到什么事了？\n\n母亲: 跟妈说说，妈给你出出主意。\n\n母亲: 不管发生什么事，家永远是你的后盾。\n\n母亲: 要是工作太忙，就请假回来几天。\n\n[options]:\n1. 妈，我真的没事，就是太忙了。\n2. 妈，我有点害怕。\n3. 妈，别管我了，我想一个人静一静。\n\n// 选项1: [妈，我真的没事，就是太忙了。] - 安抚回应\n$23:33$\n\n我: 妈，我真的没事，就是太忙了。\n\n母亲: 好吧，那你注意身体。\n\n母亲: 要是想回家了，随时回来。\n\n母亲: 家里的门永远为你开着。\n\n// -> 跳转至 [不回家结局]\n\n// 选项2: [妈，我有点害怕。] - 倾诉回应\n$23:33$\n\n我: 妈，我有点害怕。\n\n母亲: 害怕什么？跟妈说说。\n\n母亲: 不管是什么，妈都陪你一起面对。\n\n母亲: 儿子，你现在在哪里？妈现在就过去。\n\n// -> 跳转至 [回家结局]\n\n// 选项3: [妈，别管我了，我想一个人静一静。] - 拒绝回应\n$23:33$\n\n我: 妈，别管我了，我想一个人静一静。\n\n母亲: 好吧，那你好好静一静。\n\n母亲: 要是想通了，就给妈打个电话。\n\n母亲: 妈永远等着你的消息。\n\n// -> 跳转至 [不回家结局]\n\n// [母亲关心]\n$23:32$\n\n母亲: 儿子，是不是遇到什么事了？\n\n母亲: 跟妈说说，妈给你出出主意。\n\n母亲: 不管发生什么事，家永远是你的后盾。\n\n母亲: 要是难受，就回家来，妈给你做好吃的。\n\n[options]:\n1. 妈，我没事，就是有点累。\n2. 妈，我想回家。\n3. 妈，我可能不是你儿子了。\n\n// 选项1: [妈，我没事，就是有点累。] - 轻描淡写\n$23:33$\n\n我: 妈，我没事，就是有点累。\n\n母亲: 累了就回家休息，妈给你做好吃的。\n\n母亲: 什么都不用想，好好睡一觉。\n\n母亲: 家永远是你的港湾。\n\n// -> 跳转至 [回家结局]\n\n// 选项2: [妈，我想回家。] - 直接回应\n$23:33$\n\n我: 妈，我想回家。\n\n母亲: 太好了！我和你爸都等着你呢。\n\n母亲: 你现在在哪里？我让你爸去接你。\n\n母亲: 路上注意安全。\n\n// -> 跳转至 [回家结局]\n\n// 选项3: [妈，我可能不是你儿子了。] - 异常回应\n$23:33$\n\n我: 妈，我可能不是你儿子了。\n\n母亲: 你在说什么？别吓妈。\n\n母亲: 是不是最近压力太大了？\n\n母亲: 不管你变成什么样，你都是妈的儿子。\n\n// -> 跳转至 [回家结局]\n\n// [回家结局]\n$00:00$\n\n母亲: 新年快乐，儿子！\n\n母亲: 等着你回家呢。\n\n母亲: 红烧肉已经热好了。\n\n母亲: 路上注意安全。\n\n$00:30$\n\n母亲: 儿子，你到哪了？\n\n母亲: 是不是路上堵车了？\n\n母亲: 别急，妈等你。\n\n母亲: 家永远在这儿。\n\n**[回家结局：母爱的包容]**\n你选择了回家，回到了母亲的身边。无论你变成什么样，母亲都依然爱你，接纳你。这是一个温暖的结局，展现了母爱的伟大和包容。\n\n// [不回家结局]\n$00:00$\n\n母亲: 新年快乐，儿子！\n\n母亲: 虽然你不能回来，但妈理解你。\n\n母亲: 工作再忙也要注意身体。\n\n母亲: 想回家了随时回来。\n\n$00:30$\n\n母亲: 儿子，你睡了吗？\n\n母亲: 妈想你了。\n\n母亲: 不管你在哪里，妈都祝你平平安安。\n\n母亲: 家永远等着你。\n\n**[不回家结局：母亲的牵挂]**\n你选择了不回家，虽然母亲感到失望，但她依然理解你，支持你。这是一个略带遗憾的结局，但也展现了母亲的理解和包容。",avatar:Fn}},O=w((()=>{var n;return(null==(n=B[k.value])?void 0:n.name)||"未知角色"})),b=w((()=>s.getHistory(k.value))),F=p({"女友":{name:"女友",avatar:R},"陌生人":{name:"陌生人",avatar:On},"海明":{name:"海明",avatar:bn},"母亲":{name:"母亲",avatar:Fn},"我":{name:"我",avatar:Dn}});C((()=>{const n=e.params.id||"girlfriend";k.value=n,i(),u(),s.gameStarted&&s.dialogueHistory[n]||s.startGame(),s.onSanChange=n=>{V(n)};const t=B[n];t&&t.script&&(s.dialogueHistory[n]&&0!==s.dialogueHistory[n].length||a.loadAndStart(n,t.script)),x((()=>{H()})),s.setOnOsTextEnd((()=>{a.characterStates[n]&&a.characterStates[n].instructionPointer++,a.processQueue(n)}))}));const D=()=>{t.push("/")},H=()=>{g.value&&(g.value.scrollTop=g.value.scrollHeight)};let M=0;return E(b,(n=>{if(x((()=>{g.value&&(g.value.scrollTop=g.value.scrollHeight)})),n.length>M){const e=n[n.length-1];e&&"os_text"!==e.type&&o()}M=n.length}),{deep:!0}),E((()=>s.isWaitingForChoice),(n=>{x((()=>{g.value&&(g.value.scrollTop=g.value.scrollHeight)}))})),(n,e)=>(r(),c("div",{class:T(["conversation-view",{shake:y(s).screenShake}])},[h("div",te,[h("div",{class:"back-button",onClick:D},[...e[0]||(e[0]=[h("img",{src:nn,alt:"返回"},null,-1)])]),I(" "+f(O.value),1)]),h("div",{class:"message-list",ref_key:"messageList",ref:g},[(r(!0),c(v,null,S(b.value,(n=>(r(),c("div",{key:n.id},["system"===n.type?(r(),d(ne,{key:0,text:n.content},null,8,["text"])):(r(),d(Xn,{key:1,message:n,characterProfiles:F.value},null,8,["message","characterProfiles"]))])))),128))],512),y(s).isWaitingForChoice?(r(),c("div",se,[(r(!0),c(v,null,S(y(s).currentOptions,(n=>(r(),d(ee,{key:n.text,text:n.text,onSelect:e=>(n=>{a.selectOption(k.value,n)})(n)},null,8,["text","onSelect"])))),128))])):$("",!0),l(En,{text:y(s).osText.text,visible:y(s).osText.visible,isEnding:y(s).osText.isEnding,waitingForRestart:y(s).osText.waitingForRestart},null,8,["text","visible","isEnding","waitingForRestart"]),l(Bn,{visible:y(s).showEndingModal,endingType:y(s).endingType},null,8,["visible","endingType"])],2))},__scopeId:"data-v-64d16c74"};const ie={class:"ending-collection"},oe={class:"collection-content"},re={key:0,class:"empty-state"},ce={key:1,class:"ending-list"},le={class:"ending-info"},ue={__name:"EndingCollection",setup(n){const e=m(),t=K(),s=[{id:"good",title:"好结局：如常的黎明",description:'你成功地扮演了"过去的我"，用稳健和理智安抚了她，将所有异常都隔绝在她感知之外。她错过了陌生人绝望的警告，父母的短暂失联也被解释为一场误会。这个新年夜的危机似乎过去了。然而，楼下的阴影只是暂时退去，那个偏执的凝视，将在下一个黑夜，以更近的距离，重新包裹她。你为她守护了一个虚假的黎明。'},{id:"normal",title:"普通结局：未知的敲门声",description:'你的选择充满了矛盾，既没能给她足够的安全感，又激起了她无尽的恐惧。父母的失联、陌生人的警告、你的突然冷漠，一切都将她推向崩溃的边缘。你选择抽身离开，将她独自留在被未知包裹的房间里。几分钟后，她的房门被敲响了。她不知道门外是谁。是来"保护"你的我？是来警示她的陌生人？还是......终于从房间里出来的"父母"？这个新年，她将永远活在无尽的猜测和恐惧之中。'},{id:"true",title:"真结局：我的金丝雀",description:'你遵从了被替换后的本能，用最偏执的方式回应了她的依赖和你的爱。你强迫她打开了陌生人最后的警告，并用言语将其歪曲为无稽之谈，彻底切断了她与外界的联系。当门锁转动的那一刻，她才明白，楼下的陌生人、电话里的爱人、和即将进入她房间的"你"，是同一个存在。至于她的父母……或许他们从一开始就不在，或许他们再也不会醒来。从这个新年开始，她将成为你一个人的金丝雀，被囚禁在由你亲手打造的、名为"爱"的牢笼里，永远无法逃离。你们，终于"永远在一起"了。'}],a=w((()=>{const n=t.unlockedEndings||[];return s.filter((e=>n.includes(e.id)))})),i=()=>{e.push("/")};return(n,e)=>(r(),c("div",ie,[h("div",{class:"header"},[h("div",{class:"back-button",onClick:i},[...e[0]||(e[0]=[h("img",{src:nn,alt:"返回"},null,-1)])]),e[1]||(e[1]=h("h1",null,"结局收录",-1))]),h("main",oe,[y(t).unlockedEndings&&0!==y(t).unlockedEndings.length?(r(),c("div",ce,[(r(!0),c(v,null,S(a.value,(n=>(r(),c("div",{key:n.id,class:"ending-item"},[e[3]||(e[3]=h("div",{class:"ending-icon"},"📖",-1)),h("div",le,[h("h3",null,f(n.title),1),h("p",null,f(n.description),1)])])))),128))])):(r(),c("div",re,[...e[2]||(e[2]=[h("div",{class:"empty-icon"},"🔒",-1),h("h3",null,"尚未解锁任何结局",-1),h("p",null,"继续游戏，探索不同的选择，解锁更多结局吧！",-1)])]))]),l(G)]))},__scopeId:"data-v-1002d240"};const Ae={class:"contacts-view"},de={__name:"ContactsView",setup(n){const e=m(),t=()=>{e.push("/")};return(n,e)=>(r(),c("div",Ae,[h("div",{class:"header"},[h("div",{class:"back-button",onClick:t},[...e[0]||(e[0]=[h("img",{src:nn,alt:"返回"},null,-1)])]),e[1]||(e[1]=h("h1",null,"发现",-1))]),e[2]||(e[2]=h("main",{class:"contacts-content"},[h("div",{class:"empty-state"},[h("div",{class:"empty-icon"},"🔍"),h("h3",null,"发现页面"),h("p",null,"这里是发现页面，暂时没有内容")])],-1)),l(G)]))},__scopeId:"data-v-4f908124"},Ve=B(H),ge=O(),he=b({history:F(),routes:[{path:"/",name:"ChatList",component:z},{path:"/conversation/:id",name:"Conversation",component:ae,props:!0},{path:"/endings",name:"EndingCollection",component:ue},{path:"/contacts",name:"Contacts",component:de}]});Ve.use(ge),Ve.use(he),Ve.mount("#app");
